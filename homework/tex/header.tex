%\documentclass[fleqn,12pt]{exam}               % use this for no answers
\documentclass[answers,addpoints,12pt]{exam}  % use this for answers

\usepackage[usenames, dvipsnames]{color} % defines a new color
% \definecolor{SolutionColor}{rgb}{0.8,0.9,1} % light blue

\renewcommand{\solutiontitle}{\noindent\textbf{Solution}. }

%% How to print correct answer choices:
\CorrectChoiceEmphasis{\itshape\bfseries} %% <-- bold italics
%% 
\usepackage{xspace}
%% \CorrectChoiceEmphasis{\color{ForestGreen}\bfseries} %% <-- green bold
\newcommand\coursename{DS 644}
\newcommand\semester{Spring 2022}
\newcommand\assignment{Homework XX}
\newcommand\duedate{XX\xspace}

% \pointsinmargin
% \pointpoints{pt}{pts}
% \marginpointname{pts}
% \marginbonuspointname{pts}

\makeatletter
\newif\ifanswers
\@ifclasswith{exam}{answers}{\answerstrue}{\answersfalse}
\makeatother
\newcommand{\scratchpage}{%
  \ifanswers % do nothing
  \else \newpage \thispagestyle{empty} \begin{center} -- scratch -- \end{center} \fi}

\newcommand{\foo}{\ifanswers fooone\else footwo\fi}

%% Extra space between questions
\renewcommand{\questionshook}{\setlength{\itemsep}{5mm}}
% \renewcommand{\partshook}{\setlength{\topsep}{5mm}}
\renewcommand{\partshook}{\setlength{\itemsep}{5mm}}
\usepackage{amssymb}
\checkboxchar{$\Box$}% \renewcommand{\questionshook}{%
%   \setlength{\leftmargin}{0pt}%
%   \setlength{\labelwidth}{-\labelsep}%
% }
%% Change geometry if you want:
\usepackage[top=1cm, left=2cm,right=2cm,bottom=1cm]{geometry}%

\usepackage{amsmath}
\usepackage{amsthm,amssymb}
\usepackage{mathtools}
\usepackage{url,multicol,enumerate}
\usepackage{tikz}
\usepackage{comment}
\usepackage{bussproofs}
\usepackage{../unixode}
\theoremstyle{remark}
\newtheorem{theorem}{Theorem}
\newtheorem*{prop}{Proposition}
\newtheorem{problem}{Problem}
\newtheorem*{prob}{Problem}
\newtheorem*{answer}{{\bf Answer}}
\newtheorem*{answers}{{\bf Answers}}
\newtheorem*{explanation}{{\bf Explanation}}
\newtheorem*{hint}{{\it Hint}}
\newtheorem*{ex}{Exercise}



% Create a True False question format
\newcommand*{\TrueFalse}[1]{%
\ifprintanswers
    \ifthenelse{\equal{#1}{T}}{%
        \textbf{TRUE}\hspace*{14pt}False
    }{
        True\hspace*{14pt}\textbf{FALSE}
    }
\else
    {True}\hspace*{20pt}False
\fi
} 
%% The following code is based on an answer by Gonzalo Medina
%% http://tex.stackexchange.com/a/13106/39194
\newlength\TFlengthA
\newlength\TFlengthB
\settowidth\TFlengthA{\hspace*{1.16in}}
\newcommand\TFQuestion[2]{%
    \setlength\TFlengthB{\linewidth}
    \addtolength\TFlengthB{-\TFlengthA}
    \parbox[t]{\TFlengthB}{#2}
    \parbox[t]{\TFlengthA}{\TrueFalse{#1}}}

  % \usepackage{background}
  % \backgroundsetup{
  %   color=black,
  %   opacity=.25,
  %   scale=2.5,
  %   contents={\textsc{FOR PERSONAL USE ONLY -- DO NOT DISTRIBUTE}}%
  % }

\usepackage{hyperref}
%% Some of my own personal favoriate macros... (remove these if you want)
\renewcommand{\vec}[1]{\mathbf{#1}}
%% To make a boldface vector, use backslash v in front of the 
%% letter and add a new command for that letter here or in 
%% the macros.tex file:
\newcommand\im{\ensuremath{\operatorname{im}}}
\newcommand\rank{\ensuremath{\operatorname{rank}}}
\newcommand\nullity{\ensuremath{\operatorname{nullity}}}
\newcommand{\join}{\ensuremath{\vee}}
\newcommand{\meet}{\ensuremath{\wedge}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\<}{\ensuremath{\langle}}
\renewcommand{\>}{\ensuremath{\rangle}}
\newcommand{\sB}{\ensuremath{\mathcal B}}
\newcommand{\sE}{\ensuremath{\mathcal E}}
\newcommand{\ur}{\ensuremath{\underline{\mathrm{r}}}}
\newcommand{\uT}{\ensuremath{\underline{\mathrm{T}}}}
\newcommand{\uF}{\ensuremath{\underline{\mathrm{F}}}}
\newcommand{\uN}{\ensuremath{\underline{\mathrm{N}}}}
\newcommand{\ui}{\ensuremath{\underline{\mathrm{i}}}}
\newcommand{\uj}{\ensuremath{\underline{\mathrm{j}}}}
\newcommand{\ua}{\ensuremath{\underline{\mathrm{a}}}}
\newcommand{\ub}{\ensuremath{\underline{\mathrm{b}}}}
\newcommand{\un}{\ensuremath{\underline{\mathrm{n}}}}
\newcommand{\uv}{\ensuremath{\underline{\mathrm{v}}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand\vR{\ensuremath{\operatorname{R}}}
\newcommand\vN{\ensuremath{\operatorname{N}}}
\newcommand\vC{\ensuremath{\operatorname{C}}}
\newcommand\va{\vec{a}}
\newcommand\vb{\vec{b}}
\newcommand\ve{\vec{e}}
\newcommand\vE{\vec{E}}
\newcommand\vu{\vec{u}}
\newcommand\vv{\vec{v}}
\newcommand\vw{\vec{w}}
\newcommand\vs{\vec{s}}
\newcommand\vx{\vec{x}}
\newcommand\vy{\vec{y}}
\newcommand\vz{\vec{z}}
\newcommand\vzero{\vec{0}}
\newcommand{\probskip}{\vskip1.5cm}
\newcommand{\finans}[1]{\ensuremath{\underline{\underline{#1}}}}
\newcommand{\dotsize}{1pt}
\newcommand{\Heq}{\ensuremath{ \; \stackrel{\mathrm{H}}{=}} \; }


\pagestyle{foot}


\usepackage{graphicx,wrapfig,lipsum}
\input{insbox}
\usepackage{capt-of}
% \usepackage[onehalfspacing]{setspace}
\usepackage{setspace}
\usepackage{mwe}

\usepackage{etoolbox}

\makeatletter
%% Stealing some code from exam:
\def\mypointshandling
  {%>>>
    \if@bonus
      \def\padded@point@block{%
        \begingroup
          \@placepointstrue
          \bonuspoint@block
        \endgroup
      }%
    \else
      \def\padded@point@block{%
        \begingroup
          \@placepointstrue
          \point@block
        \endgroup
      }%
    \fi
    \if@pointsdropped
    \else
      \if@bonus
        \if@bonusqformat
          \ifx\ques@ref\@queslevel
          \else
            \setup@point@toks
          \fi
        \else
          \setup@point@toks
        \fi
      \else
        \if@qformat
          \ifx\ques@ref\@queslevel
          \else
            \setup@point@toks
          \fi
        \else
          \setup@point@toks
        \fi
      \fi
    \fi
    \global \MyIfPointsfalse
  }%<<<
\protected\long\def\myOargparse#1#2%>>>
  {%
    \@ifnextchar[{\myOargparse@{#2}}{#2{#1}}%
  }%<<<
\long\def\myOargparse@#1[#2]%>>>
  {%
    #1{#2}%
  }%<<<
\def\q@mark{\q@mark}
\newif\ifMyIfPoints
\newif\if@notfirstins
\protected\def\questionInsboxL%>>>
  {%
    \myOargparse{\q@mark}{\questionInsbox@a\InsertBoxL}%
  }%<<<
\protected\def\questionInsboxR%>>>
  {%
    \myOargparse{\q@mark}{\questionInsbox@a\InsertBoxR}%
  }%<<<
\protected\long\def\questionInsbox@a#1#2#3#4%>>>
  {%
    \myOargparse{0}{\questionInsbox@b{#1}{#2}{#3}{#4}}%
  }%<<<
\protected\long\def\questionInsbox@b#1#2#3#4#5%>>>
  {%
    \if@notfirstins
    \else
      \def\makelabel##1{\hss\llap{##1}}%
      \apptocmd\@itemlabel{\hskip\leftmargin}{}{}%
    \fi
    \ifx\q@mark#2%
      \question
    \else
      \global\MyIfPointstrue
      \patchcmd\@readpoints{\global\@placepointstrue}{\relax}{}{}%
      \question[{#2}]%
      \patchcmd\@readpoints{\relax}{\global\@placepointstrue}{}{}%
    \fi
    \if@notfirstins
    \else
      \patchcmd\@itemlabel{\hskip\leftmargin}{}{}{}%
      \let\makelabel\@mklab
      \@notfirstinstrue
    \fi
    \mbox{}%
    \vspace*{-\baselineskip}%
    \setlength{\leftskip}{\leftmargin}%
    \ifx\InsertBoxR#1%
      #1{#3}{\hskip-\leftmargin#4\hskip\leftmargin}[{#5}]%
    \else
      #1{\numexpr#3+1\relax}{#4}[{#5}]\par\hspace{\itemindent}%
    \fi
    \ifMyIfPoints
      \mypointshandling
    \fi
    \the\point@toks
    \ignorespaces
  }%<<<
\makeatother

  % EXAMPLE USAGE:
  % \questionInsboxR[5]{0}
  %   {%
  %     \parbox[t]{.3\linewidth}
  %       {%
  %         \centering
  %         \includegraphics[width=\linewidth]{example-image-a.png}%
  %         \captionof{figure}{This is A}%
  %       }%
  %   }[1]
  %   Hello, I want to wrap this figure in exam
  %   \lipsum[1]
  % \questionInsboxL[5]{2}
  %   {%
  %     \parbox[t]{.3\linewidth}
  %       {%
  %         \centering
  %         \includegraphics[width=\linewidth]{example-image-a.png}%
  %         \captionof{figure}{This is A}%
  %       }%
  %   }[1]
  %   Hello, I want to wrap this figure in exam
  %   \lipsum[1]



\newcommand{\figscl}{.5}
\newcommand{\tf}[1][{}]{%
  \fillin[#1][0.25in]%
}

\newcommand\explain[1]{%
  \ifanswers
  \begin{EnvUplevel}
    {\small \underline{Explanation}. #1} 
  \end{EnvUplevel}
  \else \fi}

\ifanswers
\usepackage{background}
\backgroundsetup{
  color=black,
  opacity=.25,
  scale=2,
  contents={\textsc{FOR PERSONAL USE ONLY -- DO NOT DISTRIBUTE}}%
}
\fi

\newcommand\myheader{%
  \noindent {\bf \coursename: \assignment}\hfill \ifanswers {\bf ANSWERS} \hfill {\bf \assignment} \fi%
}
